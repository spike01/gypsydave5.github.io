<!DOCTYPE html>

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      home &middot; gypsydave5
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          gypsydave5
        </a>
      </h1>
      <p class="lead">The blog of David Wickes, software developer</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>

      

      
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">About me</a>
          
        
      
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      

      <a class="sidebar-nav-item" href="https://github.com/gypsydave5">GitHub</a>
      <a class="sidebar-nav-item" href="https://twitter.com/gypsydave5">Twitter</a>
      <a class="sidebar-nav-item" href="mailto:dave@gypsydave5.com">Email</a>

    </nav>

    <p>&copy; 2015. All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2014/09/20/data_mapper/">
        Data Mapper Woes
      </a>
    </h1>

    <span class="post-date">20 Sep 2014</span>

    <p>I love <a href="http://datamapper.org/">DataMapper</a>, the lightweight Object Relational
Mapper for Ruby. We&#39;ve been using it with Sinatra. It&#39;s skinny, it&#39;s simple,
it&#39;s clever, it makes the right tables happen in Postgres and the syntax is
surprisingly simple. For instance, the email field for a user table:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">property</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">unique</span><span class="p">:</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">required</span><span class="p">:</span> <span class="kp">true</span><span class="p">,</span> <span class="nb">format</span><span class="p">:</span> <span class="n">email_address</span>
</code></pre></div>
<p>Look! It&#39;s amazing -- not only do we set the property, but we&#39;ve made it
required and unique, and we&#39;ve validated that it&#39;s an email address. Amazing!</p>

<p>I love it, but like all wonderful DSLs when it&#39;s good it&#39;s very very good, but
when it&#39;s bad it&#39;s <em>horrid</em>.</p>

<p>In the example I was working on I was creating a user which could be associated
with many posts - it was a basic Twitter like app. The user had some
requirements as above - specifically those listed for the email, but also that
the user name was unique and that the password was more than six characters
long. So far so incredibly boring.</p>

<p>I set the wheels in motion, I write a feature test in Cucumber to see if as
a user, when logged in, and I create a new post, then the post count goes up by
one (I like speaking in Gherkin). Everything looked OK - but the post wasn&#39;t
saving. And there were no useful error messages.</p>

<p><a href="http://alexpeattie.com/">Alex Peattie</a> is a hero. He&#39;s left Makers now, but
before he did he hacked through what was going on with my problem. And I mean
hacked in the manner of destroying briar patches and slaying dragons - my mouth
dropped in awe as he systematically got to the source of the problem (&quot;So, let&#39;s
force it to save...  it saves the post fine, but doesn&#39;t update the user...
hmmm...&quot;), then started dropping <code>puts</code> into the DataMapper source code after
identifying the problematic lines in the backtrace.</p>

<p>As it turns out, it was the password length that was the problem. As the User
was being updated with the new post it is being associated with, the password
requirement (6 letters or more) was kicking in - even when no password was
being submitted with the update. So the post was fine - just the user didn&#39;t,
and so prevented the post from saving.</p>

<p>Simple to fix (just tell the user model to only validate password length on
creation), but difficult to identify. I won&#39;t make that mistake again, but Alex
remains my hero for sorting that out (and giving a great demonstration
debugging). <a href="http://alex-farewell-card.herokuapp.com/">We all miss him</a>.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2014/09/12/environmentalism/">
        Environmentalism
      </a>
    </h1>

    <span class="post-date">12 Sep 2014</span>

    <p>I&#39;ve never really seen the point of environment variables until today. They&#39;ve
been slowly introduced into the syllabus at Makers during the bookmark manager
project. To start with they were a way determine which database to use; whether
the one for the test suite or the one for playing around on the local server.</p>

<p>Something like</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">env</span> <span class="o">=</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;RACK_ENV&quot;</span><span class="o">]</span> <span class="o">||</span> <span class="s2">&quot;development&quot;</span> <span class="no">DataMapper</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="ss">:default</span><span class="p">,</span>
<span class="s2">&quot;postgres://localhost/bookmark_manager_</span><span class="si">#{</span><span class="n">env</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Which is all well and good. Then it comes to getting the app up - let&#39;s say on
Heroku.</p>

<p>Heroku has PostgreSQL support, so that&#39;s taken care of by adding a plugin on the
dashboard. Tick. Pushing the application to Heroku is easy enough (as long as
you haven&#39;t spelled <code>Gemfile</code> in all caps at any point in your Git history. Who
would do that?). But then you hit the buffers, because the database isn&#39;t where
you&#39;ve told Sinatra it is.</p>

<p>So where is it? Hiding somewhere over at Amazon apparently. If you run <code>heroku
config</code> you&#39;ll see a great (OK, tiny) stack of... you guessed it... environment
variables. The two key ones to look at are <code>DATABASE_URL</code> and
<code>HEROKU_POSTGRES_PINK_URL</code>. Next to them both is a long URL that lets you know
that the nice folks at Amazon are taking care of your instance of Postgres on
the behalf of Heroku.</p>

<p>So we just jam that URL into the DataMapper setup right?</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">ruby DataMapper.setup(:default,
&quot;postgres://whole-mess-of-letters.compute-1.amazonaws:porty_goodness_here&quot;)
</code></pre></div>
<p>Wrong. That URL is a magic number, it&#39;s specific to the Heroku server you&#39;re
pushing to. But what about James? What about Vincent? Maybe they want to have an
instance of their own. Or what if Heroku go and migrate your database to another
cloud supplier? Bad times.</p>

<p>Environment variables to the rescue. Look, it&#39;s right there in the config:
<code>DATABASE_URL</code>. Just jam that sucker into the DataMapper setup. Of course, you
need to make sure that you&#39;re using it in Heroku, so maybe some sort of <code>if</code>
statement to make sure you&#39;re using it in the right place. Not pretty, but...</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="sr">/heroku/</span><span class="p">)</span>
    <span class="no">DataMapper</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="ss">:default</span><span class="p">,</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;DATABASE_URL&quot;</span><span class="o">]</span><span class="p">)</span>
<span class="k">else</span>
    <span class="no">DataMapper</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="ss">:default</span><span class="p">,</span> <span class="s2">&quot;postgres://localhost/bookmark_manager_</span><span class="si">#{</span><span class="n">env</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
<p>Environment variables. No longer a &#39;nice to have&#39;.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2014/09/09/for-fun/">
        For fun!
      </a>
    </h1>

    <span class="post-date">09 Sep 2014</span>

    <p>So the last post was a bit of a downer, right? I thought I&#39;d get it down while
things were still fresh in the mind.</p>

<p>But things aren&#39;t bad at all. Makers remains a lot of fun - if you&#39;re in a bit
of a funk the general environment of fun just pulls you through. With running
(yeah, back to running) you&#39;re not just interested in making the distance
- running in and of itself is fun. Believe me, the best days of running I&#39;ve had
are ones where I find a comfortable pace and just see where that quiet country
lane will take me. Preferably in beautiful sunshine.</p>

<p>Likewise coding. No, really.</p>

<p>A few days ago <a href="https://twitter.com/optilude">Martin Aspell</a>
from <a href="http://www.deloittedigital.com/us/">Deloitte Digital</a> came in and gave us
a lunchtime presentation. The lunchtime presentations at Makers are one of the
best perks of being here. You sit on beanbags while people from the industry
come and talk to you for twenty minutes about what they do. This can be as
diverse as data security, insurance databases, restaurant bookings and -
I&#39;ll write about this later - and a fantastic talk from <a href="http://www.deloittedigital.com/us/">Rozemary
King</a> from Pivotal labs about Product
Management (amazing insight into how an agile process is managed in the
trenches).</p>

<p>But back to Martin. He gave a talk about his life, what he&#39;s done and worked on
and a little about Deloitte Digital as well. What stuck with me most was
something he said about his relationship with writing code: he comapred it to an
addiction. He finds it relaxing - he said it calms him down in the evening, like
doing a crossword or sudoku.</p>

<p>I thought it sounded a little mad, but he&#39;s right. The last few days I&#39;ve been
taking breaks from the course by rewriting the Battleships project, playing
around with ideas and seeing what works. And for fun!</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2014/09/05/the-wall/">
        The Wall (and getting over it)
      </a>
    </h1>

    <span class="post-date">05 Sep 2014</span>

    <p>Ever run a marthon? No, me neither. I&#39;ve run a few halfs, so let&#39;s pretend
that&#39;s adequate experience to talk about marathon running.</p>

<p>Long distance runners talk about this moment when the glycogen in your body runs
out entirely. You&#39;ll get about two hours, maybe more if you train. But it&#39;ll
happen, and all your energy just - goes. Seratonin levels go up, which might
sound fun until I tell you that your dopamine goes down as well. This might be
causing some of the little voices in your head to tell you that you can&#39;t do
it. You may hallucinate. You may not be able to stand.</p>

<p>I hit the mental equivalent of the wall sometime over the week we started
learning <a href="http://www.sinatrarb.com/">Sinatra</a> at Makers. I&#39;d done my preparation,
I&#39;d learned and digested solidly. I&#39;d say I was one of the better prepared for
the next twelve weeks.</p>

<p>But you can only delay the wall - you can&#39;t put it off entirely. I ran out of
whatever mental stamina I had. And it hurt. A lot.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">Depressesed? Disheartened? Hate coding? Hate what you&#39;re doing to yourself? Hate
Sinatra (the framework)? Hate Sinatra (the singer)? Wonder what you&#39;re still
doing here? How *can* anyone learn to code in twelve weeks? Stupid. Impossible.
You&#39;d be better back at the library. Hell, you&#39;d be better back at the cannary.
Stupid brain that won&#39;t work. Stupid.
</code></pre></div>
<p>We can reach for another running metaphor: second wind. Even at the point of
greatest exertion, you can find a way to carry on. Going even faster sometimes.
Like you can push through the wall and find yourself suddenly back to normal
again.</p>

<p>This happened too - and kept happening. Because I didn&#39;t just hit one wall. I&#39;ve
hit at least three since the first one. You get <em>used</em> to it. Flailing ignorance
and mental exhaustion is aleviated by the next piece of hard-won knowldege and
skill.</p>

<p>I&#39;ve found relaxation to be as important as work. I&#39;m reading fiction again,
getting to bed in good time, appreciating a quiet beer. Taking your mind off the
problem until it&#39;s ready to be solved.</p>

<p>Thinking about philosophy, and Deleuze &amp; Guattari&#39;s <a href="http://en.wikipedia.org/wiki/A_Thousand_Plateaus">A Thousand
Plateaus</a>, I think of the
organism that can only grow by dying a little every day. Growth is painful.
Growth is hard. But nothing worthwhile was ever easy.</p>

<p>You beat it. I couldn&#39;t do Sinatra, I couldn&#39;t make it do what I wanted it to
do. But I made it do something, learned my limitations. And I enjoyed myself.
And now <a href="http://rpssd.gypsydave5.com/">you can play with it</a>.</p>

<p>The pace is picking up this week. Last week threw Sinatra in our faces. This
week is databases. Learning to program is one thing - keeping all these spinning
plates up in the air at the same time is another.</p>

<p>And only half the race run.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2014/08/24/lessons_learned/">
        Lessons Learned
      </a>
    </h1>

    <span class="post-date">24 Aug 2014</span>

    <p>Things I&#39;ve learned so far from my teachers:</p>

<h3><a href="https://twitter.com/Stephen_lloyd">Stephen</a> - Succinct Semantics</h3>

<p>I felt a little smug about my code when Steve sat next to me to see how I was
doing. I was seeing if there were any broken bikes in an array, something like</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">bikes</span><span class="o">.</span><span class="n">select</span> <span class="p">{</span><span class="o">|</span><span class="n">bike</span><span class="o">|</span> <span class="n">bike</span><span class="o">.</span><span class="n">broken?</span><span class="p">}</span><span class="o">.</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">1</span>
</code></pre></div>
<p>He took a quick look and pointed out that this was a little on the long side.
Does Ruby have an <code>any?</code> method for <code>Array</code>s? Sure enough, there in <code>Enumerable</code></p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">bikes</span><span class="o">.</span><span class="n">any?</span> <span class="p">{</span><span class="o">|</span><span class="n">bike</span><span class="o">|</span> <span class="n">bike</span><span class="o">.</span><span class="n">broken?</span><span class="p">}</span>
</code></pre></div>
<p>Better. I would have been happy. But Steve then says, try passing a the symbol
for <code>broken?</code> as a proc - something I&#39;d seen and not used.</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">bikes</span><span class="o">.</span><span class="n">any?</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:broken?</span><span class="p">)</span>
</code></pre></div>
<p>See how that&#39;s better? It says exactly what it does? Yes, I did. And I&#39;d learned
that you don&#39;t have to sacrifice succinctness to semantics and vice versa. Ruby
has enough well-named methods and techniques to create a short statement that
someone who didn&#39;t know Ruby would still understand. Lesson learned.</p>

<h3><a href="https://twitter.com/liviu_23">Mihai</a> - Delete Your Code</h3>

<p>I asked Mihai for some help changing my tests for the Boris Bikes project. I was
trying to change the RSpec tests I&#39;d written from <a href="http://programmers.stackexchange.com/questions/123627/what-are-the-london-and-chicago-schools-of-tdd">Chicago to London
style</a> having just been shown how to do doubles.</p>

<p>Start again, Mihai said. Don&#39;t be precious or treasure what you&#39;ve written
- just get rid of it and start again. You&#39;ll learn more that way.</p>

<p>Since then I&#39;ve taken immense pleasure in wiping entire projects out. And
learned more by doing that. Lesson learned.</p>

<h3><a href="https://twitter.com/ecomba">Enrique</a> - Cooking without ever having have Eaten</h3>

<p>Late in the day I asked Enrique about program design. I was worried, really
worried, that I didn&#39;t know the right way to proceed with writing a program.
He&#39;d just introduced the idea of design patterns that day, so I asked him to
recommend a book, or a checklist, or a mantra - the best way to learn some
patterns.</p>

<p>Even as I spoke, Enrique started moving him hands, miming typing in front of me.
Remember what I said earlier, he said, about coding being entirely artificial.
It&#39;s not like cooking where you know what food is and what it tastes like. It&#39;s
like cooking when you&#39;ve never eaten food, have no idea what good or bad food
tastes like. The only way you&#39;ll learn is by writing code, a lot of code. Then
your instincts, your taste and intuition, will improve.</p>

<p>It was only later that I connected this advice up with <a href="http://en.wikipedia.org/wiki/Henri_Bergson#Creativity">Bergson&#39;s ideas about
creativity, specifically the swimming example</a>. You wouldn&#39;t think
a person could swim if you only ever saw them walk, the argument goes. For
swimming to be intellectually comprehendable, you&#39;ve got to throw yourself in
the water first. You can&#39;t theorize about things you haven&#39;t done - intuition
must take the lead, intelligence is a not a speculative faculty, but a practical one.</p>

<p>Mind blown, I staggered home, ignored <em>The RSpec Book</em> and wrote more code.
Lesson learned.</p>

  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page5">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page3">Newer</a>
    
  
</div>
    </div>

  </body>
</html>
